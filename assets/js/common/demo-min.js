/*! doc 2013-12-17 */
define("common/demo",["bui/common","bui/toolbar","bui/overlay"],function(t){function e(){return o.dialog||(o.dialog=new a({title:"Demo",elCls:"demo-dialog",width:800,height:500})),o.dialog}var r=t("bui/common"),n=t("bui/toolbar"),i=t("bui/overlay"),a=i.Dialog,o=r.Component.Controller.extend({renderUI:function(){var t=this,e=t.get("tpl"),r=t.get("el"),i=t.get("tbar");$(e).appendTo(r),i.render=t.get("el").find(".panel-header"),i=new n.Bar(i),i.render(),t.set("tbar",i)},bindUI:function(){var t=this,e=t.get("tbar");e.on("click",function(e){var r=e.target,n=r.get("type");"run"==n?t.run():"source"==n&&t.showSource()})},fetchSource:function(){var t=this,e=t.get("redirectUrl"),r=t.get("url");$.ajax({dataType:"jsonp",url:e,data:{file:r},success:function(e){t.set("source",e)},error:function(){}})},run:function(){var t=this,e=t.get("dialog"),n=t.get("runTpl"),i=t.get("url");n=r.substitute(n,{src:i}),e.set("bodyContent",n),e.show()},showScriptCode:function(){var t=this,e=t.get("el"),r=t.getScriptCode(),n=e.find(".panel-body");r=r.replace(/\\/gi,"<br/>"),n.html(r),window.prettyPrintEl&&prettyPrintEl(n[0])},getScriptCode:function(t){var e,r=this,n=r.get("beginTag"),i=r.get("endTag");return t=t||r.get("source"),e=t.indexOf(n),t=t.substring(e+n.length),e=t.lastIndexOf(i),-1!==e&&(t=t.substring(0,e)),t},showSource:function(){var t=this,e=t.get("source"),r=t.get("dialog"),n=t.get("sourceTpl"),i=$(n);r.set("bodyContent",i),i.html(e),r.show()},_uiSetSource:function(t){var e=this;e.showScriptCode(t)}},{_dialog:null,ATTRS:{redirectUrl:{value:"http://www.builive.com/fetchdemo.php"},dialog:{getter:function(){return e()}},beginTag:{value:"&lt;!-- script start--&gt;  \n"},endTag:{value:"&lt;!-- script end --&gt;"},sourceTpl:{value:"<textarea></textarea>"},runTpl:{value:'<iframe width="100%" height="100%" src="{src}" frameborder="0"></iframe>'},source:{},url:{},tbar:{value:{elCls:"button-group pull-right",defaultChildCfg:{elCls:"button button-small"},children:[{content:"运行",type:"run"},{content:"源码",type:"source"}]}},tpl:{value:'<div class="panel"><div class="panel-header">代码示例</div><pre class="panel-body"></pre></div>'}}},{xclass:"demo"});return o});